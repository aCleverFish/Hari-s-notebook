# 存储过程

## 1.存储过程的概念

​	存储过程（Stored Procedure）是存储在SQL Server数据库中的一种编译对象。它是一组为了完成特定功能的SQL语句集，这些SQL语句集经编译后存储在数据库中，可以被客户机管理工具、应用程序和其他存储过程调用，同时可以传递参数。用户通过指定存储过程的名字并给出参数（如果该存储过程有参数）来执行它。

​	存储过程可以：接受输入参数并以输出参数的形式将多个值返回至调用过程或批处理、包含执行数据库操作（包括调用其他过程）的编译语句、向调用过程或批处理返回状态值，以表明成功或失败（以及失败原因）

# 触发器

## 1.触发器的概念

​	触发器是一种特殊的存储过程，其中包含一系列的T-SQL语句，但它的执行不是用EXECUTE命令显示调用，而是在满足==一定条件下自动激活而执行==，如向表中插入记录、更新记录或者删除记录时被系统自动地激活并执行。

​	触发器与存储过程的==区别==在于触发器能够==自动执行并且不含有参数==

## 2.使用触发器的优点

​	①触发器时在某个事件发生时自动激活而执行的。如，在数据库中定义了某个对象之后，或对表中的数据做了某种修改之后立即被激活并自动执行

​	②触发器可以实现比约束更完整性的要求，比如CHECK约束中不能引用其他表中的列，而触发器可以引用；CHECK约束只是由逻辑符号连接的条件表达式，不能完成复杂的逻辑判断功能

​	③触发器可以根据表数据修改前后的状态，根据其差异采取相应的措施

​	④触发器可以防止恶意的或错误的INSERT、UPDATE、DELETE操作

## 3.触发器的种类

①DML触发器 是在执行数据操纵语言（DML）事件时被激活而自动执行的触发器。即当数据库服务器发生对数据表中的数据进行插入（INSERT）、修改（UPDATE）和删除（DELETE）操作（即数据操纵DML）事件时自动运行的存储过程。根据触发器代码执行的时机，DML触发器可以分为两种：After触发器和Instead of触发器

​	After：After触发器实在执行了INSERT、UPDATE、或DELETE语句操作之后激活执行的触发器，即在记录已经改变完成之后（After），才会被激活执行，因此，它主要时用于记录数据变更后的处理或检查。这种触发器只能在表上定义，不能在视图上定义

​	Instead of ：Instead of 触发器用来代替激活触发器的DML操作（INSERT、UPDATE、DELETE）的执行，即在记录变更之前，不去执行原来SQL语句里的INSERT、UPDATE、DELETE操作，而去执行触发器中的代码所定义的操作。Instead of 触发器可以定义在表和视图上

②DDL触发器

​	DDL触发器是在相应各种数据定义语言(DDL)事件时而激活执行的存储过程，这些事件主要与以关键字CREATE、ALTER、和DROP开头的T-SQL语句对应。DDL触发器一般用于执行数据库中的管理任务，如审核和规范数据库操作、防止数据库表结构被修改等。

# Reader 和 Adapter的用法

## 1.DataReader

1.使用DataReader需要对集合（List）配合使用，封装较为麻烦

2.但对集合作为数据源能够体现更好的面向对象特性

3.DataReader用类似于指针的方式读取数据库中的数据，在不取用数据库数据的情况下，Datareader以只进只读的方式读取数据。DataReader是一种高效读取数据流的方式。

## 2.DataAdapter

1.与DataSet配合使用，后台无需单独封装，编写简单

2.但不能更好的体现面向对象编程特性

3.DataAdapter是数据访问适配器，适配了数据库和应用程序之间的隔阂。将数据一次加载到内存后便断开与数据库的连接。不适用于大量数据读取，在读取大量数据的过程中，要是出现数据量超越内存容量便会卡死。DataAdapter是DataReader封装而来的。

## 数据库技术

在数据库中，拥有三种策略，在一个表中删除的时候，一是可以删除当前表和关联的表，二是不允许删除

## 左连接、右连接、内连接

### 左连接定义

​	左连接的定义：是以左表为基础，根据ON后给出的两表的条件将两表连接起来。结果会将左表所有的查询信息列出，而右表只列出ON后条件与左表满足的部分。左连接全称为左外连接，是外连接的一种。

##右连接的定义

​	右连接的定义，是以右表为基础，根据ON后给出的两表的条件将两表连接起来。结果会将右表所有的查询信息列出，而左表只列出ON后条件与右表满足的部分。右连接全称为右外连接，是外连接的一种。

## 内连接

内链接：使用比较运算符根据每个表共有的列的值匹配两个表中的行；

